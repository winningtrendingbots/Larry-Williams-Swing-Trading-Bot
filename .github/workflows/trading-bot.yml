# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ARCHIVO 1: .github/workflows/trading-bot.yml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Este archivo debe estar en: .github/workflows/trading-bot.yml

name: Kraken Swing Trading Bot

# Configurar cuÃ¡ndo se ejecuta el bot
on:
  # Ejecutar automÃ¡ticamente cada hora
  schedule:
    - cron: '*/15 * * * *'  # Cada hora en punto (00:00, 01:00, 02:00, etc.)
  
  # TambiÃ©n permitir ejecuciÃ³n manual desde GitHub
  workflow_dispatch:
    inputs:
      dry_run:
        description: 'Ejecutar en modo simulaciÃ³n (true/false)'
        required: false
        default: 'true'

jobs:
  trade:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout cÃ³digo
      uses: actions/checkout@v4
    
    - name: ğŸ Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        cache: 'pip'
    
    - name: ğŸ“¦ Instalar dependencias
      run: |
        python -m pip install --upgrade pip
        pip install requests pandas numpy
    
    - name: ğŸš€ Ejecutar bot de trading
      env:
        # Credenciales de Kraken (configurar en GitHub Secrets)
        KRAKEN_API_KEY: ${{ secrets.KRAKEN_API_KEY }}
        KRAKEN_API_SECRET: ${{ secrets.KRAKEN_API_SECRET }}
        
        # Credenciales de Telegram (configurar en GitHub Secrets)
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        
        # ConfiguraciÃ³n de trading
        POSITION_SIZE_PCT: ${{ secrets.POSITION_SIZE_PCT || '0.25' }}
        LEVERAGE: ${{ secrets.LEVERAGE || '3' }}
        SWING_LEVEL: ${{ secrets.SWING_LEVEL || 'intermediate' }}
        LOOKBACK_CANDLES: ${{ secrets.LOOKBACK_CANDLES || '500' }}
        CANDLE_INTERVAL: ${{ secrets.CANDLE_INTERVAL || '60' }}
        
        # GestiÃ³n de riesgo
        MAX_DRAWDOWN_PCT: ${{ secrets.MAX_DRAWDOWN_PCT || '20.0' }}
        MAX_LOSS_PER_TRADE_PCT: ${{ secrets.MAX_LOSS_PER_TRADE_PCT || '5.0' }}
        MIN_BALANCE_USD: ${{ secrets.MIN_BALANCE_USD || '100.0' }}
        
        # Modo de ejecuciÃ³n
        DRY_RUN: ${{ github.event.inputs.dry_run || 'false' }}
      
      run: |
        python kraken_trading_bot.py
    
    - name: ğŸ“Š Subir logs (si hay error)
      if: failure()
      uses: actions/upload-artifact@v4
      with:
        name: trading-logs
        path: |
          *.log
          *.txt
        retention-days: 7
